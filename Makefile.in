#Makefile for kat library
#Adjust the setting for your environment
BINDIR=bin
LIBDIR=lib
SRCDIR=src
INSTALLDIR=/srv/http/kat

init:
	mkdir -p $(BINDIR)
	printf "\n\n\n\n" > fileseparator

libjs: init $(LIBDIR)/Bootstrap/js/bootstrap.min.js $(LIBDIR)/FlancheJs/flanchejs.js $(LIBDIR)/jQuery/jquery.js	$(LIBDIR)/underscorejs/underscore.js
	cat $(LIBDIR)/jQuery/jquery.js   fileseparator                     \
	$(LIBDIR)/FlancheJs/flanchejs.js fileseparator                     \
	$(LIBDIR)/underscorejs/underscore.js                               \
	$(LIBDIR)/Bootstrap/js/bootstrap.min.js                            > $(BINDIR)/kat_lib.js

libcss: init $(LIBDIR)/Bootstrap/css/bootstrap.min.css
	cat $(LIBDIR)/Bootstrap/css/bootstrap.min.css                      > $(BINDIR)/kat_lib.css

srcjs: init 	$(SRCDIR)/js/util/Util.js
	cat $(SRCDIR)/js/util/Util.js fileseparator                        \
	$(SRCDIR)/js/util/Constants.js fileseparator                       \
	$(SRCDIR)/js/util/XMLDoc.js fileseparator                          \
	$(SRCDIR)/js/KATService.js fileseparator                           \
	$(SRCDIR)/js/FormProcessor.js fileseparator                        \
	$(SRCDIR)/js/TextPreprocessor.js fileseparator                     > $(BINDIR)/kat_src.js

srccss: init $(SRCDIR)/css/kat.css
	cat $(SRCDIR)/css/kat.css                                          > $(BINDIR)/kat_src.css

js: init libjs srcjs
	cat	$(BINDIR)/kat_lib.js fileseparator $(BINDIR)/kat_src.js        > $(BINDIR)/kat.js

css: init libcss srccss
	cat $(BINDIR)/kat_lib.css fileseparator $(BINDIR)/kat_src.css      > $(BINDIR)/kat.css

img: $(LIBDIR)/Bootstrap/img
	cp -R $(LIBDIR)/Bootstrap/img $(BINDIR)/img

all: js css	img
	@echo -e "\n\n#>The build is complete\n\n"

clean:
	rm -rf $(BINDIR)
	rm fileseparator

install: test bin
	rm -rf $(INSTALLDIR)
	mkdir -p $(INSTALLDIR)
	cp -R test $(INSTALLDIR)/test
	cp -R bin  $(INSTALLDIR)/bin
	@echo -e "\n\n#>Installation complete\n\n"
